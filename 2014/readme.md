Solution is based on following explanation:

https://a3nm.net/blog/google_hashcode_2014.html
